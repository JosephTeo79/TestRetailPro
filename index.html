<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SubMain</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  #bot-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #007bff;
    color: white;
    font-size: 24px;
    border: none;
    cursor: pointer;
    z-index: 1000;
  }
</style>
</head>
<body>

<h1>SubMain Page</h1>
<p>è¿™é‡Œæ˜¯ SubMain å†…å®¹ã€‚</p>

<button id="bot-button">ğŸ’¬</button>

<!-- âœ… å®˜æ–¹ v3.5 CDN -->
<script src="https://cdn.botpress.cloud/webchat/v3.5/inject.js"></script>
<script>
const entry = "SubMain";
let initialized = false;

function initBotpress() {
  if (!initialized && window.botpressWebChat) {
    window.botpressWebChat.init({
      botId: "XSX123E9",
      hostUrl: "https://messaging.botpress.cloud",
      messagingUrl: "https://messaging.botpress.cloud",
      showPoweredBy: false,
      enableConversationDeletion: false,
      extraData: { entry } // ä¼ ç»™ Flow
    });
    initialized = true;
  }
}

document.getElementById('bot-button').addEventListener('click', () => {
  // ç¡®ä¿ botpressWebChat å·²åŠ è½½
  if (!window.botpressWebChat) {
    console.error("Botpress Webchat not loaded yet!");
    return;
  }

  initBotpress();

  // æ‰“å¼€èŠå¤©çª—å£
  window.botpressWebChat.open();

  // å‘é€è‡ªå®šä¹‰äº‹ä»¶
  window.botpressWebChat.sendEvent({
    type: "custom",
    channel: "web",
    payload: { entry }
  });
});
</script>

</body>
</html>
