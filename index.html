<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>SubMain - Retail Pro Prism</title>
<style>
  body { font-family: Arial, sans-serif; }
  #bot-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #007bff;
    color: white;
    font-size: 24px;
    border: none;
    cursor: pointer;
    z-index: 1000;
  }
  #bot-iframe {
    position: fixed;
    bottom: 90px;
    right: 20px;
    width: 400px;
    height: 500px;
    border: 1px solid #ccc;
    border-radius: 8px;
    display: none;
    z-index: 999;
  }
</style>
</head>
<body>
<h1>SubMain Page</h1>
<p>è¿™é‡Œæ˜¯ SubMain å†…å®¹ã€‚</p>

<!-- Botpress æŒ‰é’®å’Œ iframe -->
<button id="bot-button">ğŸ’¬</button>
<iframe id="bot-iframe"></iframe>

<script>
  const botButton = document.getElementById('bot-button');
  const botIframe = document.getElementById('bot-iframe');

  // è¿™é‡Œç›´æ¥ç”¨ shareable.html + configUrl æ‰“å¼€ Bot
  const botUrl = "https://cdn.botpress.cloud/webchat/v3.5/shareable.html?configUrl=https://files.bpcontent.cloud/2025/12/22/00/20251222001942-XSX123E9.json";

  let botLoaded = false;

  botButton.addEventListener('click', () => {
    if (!botLoaded) {
      // ç¬¬ä¸€æ¬¡åŠ è½½ iframe
      botIframe.src = botUrl;
      botLoaded = true;

      // ç­‰ iframe åŠ è½½å®Œæˆå†å‘é€ SubMain æ¬¢è¿äº‹ä»¶
      botIframe.onload = () => {
        // å› ä¸ºä¸èƒ½ç”¨ extraDataï¼Œæˆ‘ä»¬ç”¨ custom event æ¨¡æ‹Ÿ SubMain
        // ä½ éœ€è¦åœ¨ Bot Studio çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åŠ ä¸€ä¸ª custom trigger: type = "custom", payload.entry = "submain"
        botIframe.contentWindow.postMessage({
          type: 'custom',
          payload: { entry: 'submain', message: 'Welcome to SubMain!' }
        }, '*');
      };
    }

    // æ˜¾ç¤ºæˆ–éšè— iframe
    botIframe.style.display = botIframe.style.display === 'none' ? 'block' : 'none';
  });
</script>
</body>
</html>
