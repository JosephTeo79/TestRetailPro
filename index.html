<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Botpress - Get User Data Template</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .info-box {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 { color: #333; }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>Get User Data Template</h1>

  <div class="info-box">
    <h3>User Data Sent to Bot</h3>
    <p><strong>Email2:</strong> <span id="user-email">test.user@example.com</span></p>
    <p><strong>Page:</strong> <span id="page-name">Homepage</span></p>
    <p><strong>Category:</strong> <span id="category">general</span></p>
  </div>

  <button onclick="clearChat()">clean bot1</button>
  <button id="triggerBotAction1">Button1</button>
  
  <!-- Botpress Webchat -->
  <script src="https://cdn.botpress.cloud/webchat/v3.3/inject.js"></script>

  <script>
    // Initialize Botpress
    window.botpress.init({
      "botId": "a513dc7b-a61b-4a0e-b0c2-79292f0f64b8",
      "clientId": "a77753bd-2319-48dd-a782-9d6ba282b204",
      "configuration": {
        "botName": "Assistant",
        "color": "#3498db"
      }
    });

    // When webchat is ready
    window.botpress.on('webchat:initialized', () => {
      console.log('✅ Webchat initialized');

      // STEP 1: Upd2ate User with data
      window.botpress.updateUser({
        data: {
          email: "test.user@example.com",
          page_name: "RetailPro",
          category: "general",
          timestamp: new Date().toISOString()
        }
      });

      console.log('✅ User data sent to bot:', {
        email: "test.user@example.com",
        page_name: "Homepage",
        category: "general"
      });
    });




window.botpressWebChat.on('webchat:ready', () => {
document.getElementById('triggerBotAction1').addEventListener('click',async()=>{
const customerPayload={
trigger:"action1"
};
await window.botpress.sendEvent(customerPayload);
});
  });
});

    

function clearChat() {
  if (window.botpress && window.botpress.sendEvent) {
    window.botpress.sendEvent({
      type: "trigger",    // 必须是 trigger 类型
      name: "action1",    // 你在 Botpress Studio 里定义的 trigger 名称
      payload: {}         // 可选
    });
    console.log('Trigger sent ✅');
  } else {
    console.error('Botpress not ready yet!');
  }
}

  </script>


</body>
</html>
